{% extends 'core.html' %}
{% block header %}
  <h1>{% block title %}{% endblock %}</h1>
{% endblock %}

{% block content %}
  <!-- Header -->
  <div class="bubble" id="payload">
    <div style="text-align: center;">
      <h3>Nintendo Switch RCM Payload Injector</h3>
      <form id="mainForm" style="text-align: left; display: inline-block;">
        <p>
          <input  type="radio" name="payload" id="Lockpick_RCM.bin" value="Lockpick_RCM.bin">
          <label for="Lockpick_RCM.bin">Lockpick RCM (<a href="https://github.com/shchmue/Lockpick_RCM/releases">v1.8.4</a>)</label>
        </p>
        <p>
          <input  type="radio" name="payload" id="hekate_ctcaer.bin" value="hekate_ctcaer.bin" checked>
          <label for="hekate_ctcaer.bin">CTCaer hekate (<a href="https://github.com/CTCaer/hekate/releases">v5.3.2</a>)</label>
        </p>
        <p>
          <input  type="radio" name="payload" id="fusee-primary.bin" value="fusee-primary.bin">
          <label for="fusee-primary.bin">Atmosphere fusee-primary (<a href="https://github.com/Atmosphere-NX/Atmosphere/releases">v0.14.1</a>)</label>
        </p>
        <p>
          <input  type="radio" name="payload" id="uploaded" value="uploaded">
          <input type="file" id="payloadUpload" class="fileinput_rcm"/>
        </p>
      </form>
    </div>
    <div style="text-align: center;">
      <button id="goButton">Inject Payload</button>
    </div>
  	<div id="results" style="text-align: center;">
      <h3 >Result:</h3>
      <textarea id="output" cols="80" rows="12" id="output"></textarea>
  	</div>
    <script src="{{ url_for('static', filename='js/rcm.js') }}"></script>
  </div>

  <!-- Services -->
  <div class="bubble" id="instructions">
    <h1 class="compact"><b>Instructions :</b></h1>
    <p>
      <ol>
        <li>Put the Switch in RCM and connect it to your device. (Insert your jig into right-joycon rail and hold volume-up while powering it on)</li>
        <li>Select one of the example payloads, or upload one.</li>
        <li>Press 'Do the thing!'</li>
        <li>On the consent screen that appears, select 'APX' and hit confirm. If APX does not appear, ensure your device is in RCM and connected.</li>
        <li>If all goes well, the payload will launch!</li>
      </ol>
    </p>
  </div>
  
  <!-- Designers -->
  <div class="bubble" id="additional">
    <h1 class="compact"><b>Extra Info :</b></h1>
    <p>
      <ul>
        <li>Continue at your own risk!</li>
        <li>This does NOT work on Windows due to a limitation in the Chrome implementation of WebUSB (and probably other reasons!) On Windows, you can use <a href="https://switchtools.sshnuke.net">TegraRcmSmash</a></li>
        <li>This does NOT currently work on any browser but Chrome, because they don't implement WebUSB.</li>
        <li>On Linux, you might get an access denied error!
          If you do, you can try creating a file at <code>/etc/udev/rules.d/50-switch.rules</code>
          <div>With the following contents:</div>
          <div><code>SUBSYSTEM=="usb", ATTR{idVendor}=="0955", MODE="0664", GROUP="plugdev"</code></div>
        </li>
        <li>This has been tested and appears to work on Linux, macOS, Android (unrooted) and Chromebooks.</li>
      </ul>
    </p>
  </div>

  <!-- Packages / Pricing Tables -->
  <div class="bubble" id="about">
    <h1 class="compact"><b>About.</b></h1>
    <p>Fusee Launcher ported to JavaScript using WebUSB.</p>
    <p>
      Source can be found on <a href="https://gitlab.com/4TU/switch.exploit">GitLab</a> under the MIT license (or by hitting view source, there is no backend!).
      <br>Ported from <a href="https://github.com/reswitched/fusee-launcher">fusee-launcher</a>.
      <br>Thanks to ktemkin and ReSwitched for Fusée Gelée and a ton of other things!
      <br>Web exploit code developed by <a href="https://github.com/atlas44/web-fusee-launcher">atlas44</a>.
    </p>
  </div>
{% endblock %}